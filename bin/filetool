#!/usr/bin/env ruby
require_relative "../lib/filetool.rb"

if __FILE__ == $0
  
  command = ARGV[0]
  filename = ARGV[1]
  arg1 = ARGV[2]
  arg2 = ARGV[3]

  if command.nil? || filename.nil?
    puts "Usage:"
    puts " filetool show <file>"
    puts " filetool stats <file>"
    puts " filetool add <file> \"text\""
    puts " filetool search <file> \"text\""
    exit
  end

  unless File.exist?(filename)
    puts "File not found: #{filename}"
    exit
  end

  case command
  when "show"
    puts Filetool.show(filename)

  when "stats"
    result = Filetool.stats(filename)
    puts "Lines: #{result[:lines]}"
    puts "Words: #{result[:words]}"
    puts "Chars: #{result[:chars]}"

  when "add"
    if arg1.nil?
      puts "Text to add is missing"
      exit
    end
    Filetool.add(filename, arg1)
    puts "Added text to #{filename}"

  when "search"
    if arg1.nil?
      puts "string to search is missing"
      exit
    end
    puts Filetool.search(filename, arg1)

  else
    puts "unknown command: #{command}"
  end
end